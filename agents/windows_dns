# Global

LogLevel  INFO
LogFile  %MYLOGFILE%

# EXTENSIONS

<Extension admin>
  Module         xm_admin
  LogLevel       WARNING
  Host           agents.nxlog.mcc.dom:5515
  SocketType     SSL
  CAFile         %CERTDIR%/agent-ca.pem
  CertFile       %CERTDIR%/agent-cert.pem
  CertKeyFile    %CERTDIR%/agent-key.pem

  <ACL conf>
    Directory     %CONFDIR%
    AllowRead     TRUE
    AllowWrite    TRUE
  </ACL>

  <ACL cert>
    Directory     %CERTDIR%
    AllowRead     TRUE
    AllowWrite    TRUE
  </ACL>
</Extension>

<Extension syslog>
  Module      xm_syslog
</Extension>

# INPUTS

# DNS ETW provider on DC1 (make sure im_etw is available and provider name exists)

<Input ETW>
  Module         im_etw
  <Provider>
    Name     Microsoft-Windows-DNSServer
    Level    Verbose
  </Provider>
</Input>

# OUTPUTS

<Output om_udp_1>
  Module        om_udp
  Host          10.1.20.99:514

# Optional: normalize hostname to FQDN before formatting

# IMPORTANT: call the xm_syslog instance correctly
  <Exec>
    $Hostname = hostname_fqdn();
  </Exec>
  Exec     syslog->to_syslog_snare();
</Output>

# ROUTES

<Route dns_etw_route>
    Path ETW  => om_udp_1
</Route>
